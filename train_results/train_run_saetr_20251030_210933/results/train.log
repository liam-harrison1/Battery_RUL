2025-10-30 21:09:33,574 - INFO - ============================================================
2025-10-30 21:09:33,574 - INFO - Starting training: Model = SAETR
2025-10-30 21:09:33,574 - INFO - Device: cuda
2025-10-30 21:09:33,574 - INFO - Config: {'paths': {'data_dir': 'data/final_dataset', 'processed_dir': 'data/processed', 'experiment_base_dir': 'train_results', 'checkpoint_dir': 'train_results\\train_run_saetr_20251030_210933\\checkpoints', 'results_dir': 'train_results\\train_run_saetr_20251030_210933\\results'}, 'data_params': {'window': 50, 'stride': 10, 'min_cycles': 180}, 'model_params': {'sae_dim': 64, 'd_model': 128, 'nhead': 4, 'nlayers': 2, 'use_cnn': True, 'cnn_channels': 64, 'quantiles': [0.1, 0.5, 0.9]}, 'train_params': {'batch_size': 128, 'epochs': 200, 'learning_rate': 0.0005, 'weight_decay': 3e-05, 'alpha_recon': 0.2, 'beta_sparse': 0.001, 'y_transform': 'standardize', 'patience': 20, 'grad_clip': 1.0}, 'eval_params': {'tau': 0.8}, 'early_prediction': {'thresholds': [30, 50, 75, 100, 150], 'min_cycles': 20, 'methods': ['saetr', 'partial_discharge', 'knee_point', 'ensemble'], 'knee_detection': {'threshold_drop': 0.02, 'min_cycles_before_knee': 30}, 'partial_discharge': {'voltage_range': [3.5, 3.1]}, 'iterative': {'max_future_cycles': 500, 'feature_prediction_method': 'linear'}}}
2025-10-30 21:09:33,575 - INFO - ============================================================
2025-10-30 21:09:33,575 - INFO - Loading data...
2025-10-30 21:09:33,582 - INFO - Train: X(7239, 50, 10), y(7239,)
2025-10-30 21:09:33,582 - INFO - Val:   X(1863, 50, 10), y(1863,)
2025-10-30 21:09:33,582 - INFO - Test:  X(1375, 50, 10), y(1375,)
2025-10-30 21:09:33,582 - INFO - Fitting StandardScaler on training data...
2025-10-30 21:09:33,642 - INFO - Saved scaler to train_results\train_run_saetr_20251030_210933\checkpoints\scaler.json
2025-10-30 21:09:33,642 - INFO - Applied y_transform: standardize
2025-10-30 21:09:33,642 - INFO - Sequence length: 50, Features: 10
2025-10-30 21:09:33,643 - INFO - Initializing SAETR model...
2025-10-30 21:09:34,379 - INFO - Model parameters: 325,709
2025-10-30 21:09:34,380 - INFO - Starting training...
2025-10-30 21:09:35,131 - INFO - Validation MAE (transformed scale): 0.3660, (original scale): 135.2078
2025-10-30 21:09:35,680 - INFO - Validation MAE (transformed scale): 0.3124, (original scale): 115.4023
2025-10-30 21:09:36,196 - INFO - Validation MAE (transformed scale): 0.3016, (original scale): 111.4117
2025-10-30 21:09:36,729 - INFO - Validation MAE (transformed scale): 0.2769, (original scale): 102.2821
2025-10-30 21:09:37,236 - INFO - Validation MAE (transformed scale): 0.2640, (original scale): 97.5163
2025-10-30 21:09:37,779 - INFO - Validation MAE (transformed scale): 0.2530, (original scale): 93.4579
2025-10-30 21:09:38,310 - INFO - Validation MAE (transformed scale): 0.2316, (original scale): 85.5661
2025-10-30 21:09:38,828 - INFO - Validation MAE (transformed scale): 0.2137, (original scale): 78.9551
2025-10-30 21:09:39,334 - INFO - Validation MAE (transformed scale): 0.1846, (original scale): 68.2098
2025-10-30 21:09:39,849 - INFO - Validation MAE (transformed scale): 0.2080, (original scale): 76.8288
2025-10-30 21:09:39,850 - INFO - Epoch 010 | Loss=0.0343 | Val MAE=0.2080 | lr=5.00e-04
2025-10-30 21:09:40,341 - INFO - Validation MAE (transformed scale): 0.1956, (original scale): 72.2484
2025-10-30 21:09:40,841 - INFO - Validation MAE (transformed scale): 0.1802, (original scale): 66.5630
2025-10-30 21:09:41,395 - INFO - Validation MAE (transformed scale): 0.1855, (original scale): 68.5371
2025-10-30 21:09:41,892 - INFO - Validation MAE (transformed scale): 0.1267, (original scale): 46.8104
2025-10-30 21:09:42,396 - INFO - Validation MAE (transformed scale): 0.1222, (original scale): 45.1284
2025-10-30 21:09:42,900 - INFO - Validation MAE (transformed scale): 0.1268, (original scale): 46.8395
2025-10-30 21:09:43,381 - INFO - Validation MAE (transformed scale): 0.1057, (original scale): 39.0347
2025-10-30 21:09:43,935 - INFO - Validation MAE (transformed scale): 0.1156, (original scale): 42.7091
2025-10-30 21:09:44,430 - INFO - Validation MAE (transformed scale): 0.1163, (original scale): 42.9576
2025-10-30 21:09:44,942 - INFO - Validation MAE (transformed scale): 0.1411, (original scale): 52.1245
2025-10-30 21:09:44,943 - INFO - Epoch 020 | Loss=0.0194 | Val MAE=0.1411 | lr=5.00e-04
2025-10-30 21:09:45,438 - INFO - Validation MAE (transformed scale): 0.1135, (original scale): 41.9416
2025-10-30 21:09:45,937 - INFO - Validation MAE (transformed scale): 0.1079, (original scale): 39.8771
2025-10-30 21:09:46,431 - INFO - Validation MAE (transformed scale): 0.1214, (original scale): 44.8472
2025-10-30 21:09:46,934 - INFO - Validation MAE (transformed scale): 0.0952, (original scale): 35.1532
2025-10-30 21:09:47,441 - INFO - Validation MAE (transformed scale): 0.0906, (original scale): 33.4787
2025-10-30 21:09:47,948 - INFO - Validation MAE (transformed scale): 0.0913, (original scale): 33.7258
2025-10-30 21:09:48,456 - INFO - Validation MAE (transformed scale): 0.0960, (original scale): 35.4640
2025-10-30 21:09:48,949 - INFO - Validation MAE (transformed scale): 0.0853, (original scale): 31.5028
2025-10-30 21:09:49,435 - INFO - Validation MAE (transformed scale): 0.0918, (original scale): 33.9076
2025-10-30 21:09:49,935 - INFO - Validation MAE (transformed scale): 0.0890, (original scale): 32.8589
2025-10-30 21:09:49,935 - INFO - Epoch 030 | Loss=0.0129 | Val MAE=0.0890 | lr=2.50e-04
2025-10-30 21:09:50,422 - INFO - Validation MAE (transformed scale): 0.0718, (original scale): 26.5309
2025-10-30 21:09:50,923 - INFO - Validation MAE (transformed scale): 0.0858, (original scale): 31.6837
2025-10-30 21:09:51,426 - INFO - Validation MAE (transformed scale): 0.0747, (original scale): 27.6012
2025-10-30 21:09:51,932 - INFO - Validation MAE (transformed scale): 0.0871, (original scale): 32.1644
2025-10-30 21:09:52,421 - INFO - Validation MAE (transformed scale): 0.0759, (original scale): 28.0471
2025-10-30 21:09:52,422 - INFO - Epoch 035 | Loss=0.0129 | Val MAE=0.0759 | lr=2.50e-04
2025-10-30 21:09:52,931 - INFO - Validation MAE (transformed scale): 0.0810, (original scale): 29.9377
2025-10-30 21:09:53,426 - INFO - Validation MAE (transformed scale): 0.0819, (original scale): 30.2619
2025-10-30 21:09:53,945 - INFO - Validation MAE (transformed scale): 0.0882, (original scale): 32.5889
2025-10-30 21:09:54,442 - INFO - Validation MAE (transformed scale): 0.0821, (original scale): 30.3361
2025-10-30 21:09:54,938 - INFO - Validation MAE (transformed scale): 0.0875, (original scale): 32.3283
2025-10-30 21:09:54,939 - INFO - Epoch 040 | Loss=0.0101 | Val MAE=0.0875 | lr=1.25e-04
2025-10-30 21:09:55,423 - INFO - Validation MAE (transformed scale): 0.0842, (original scale): 31.1049
2025-10-30 21:09:55,917 - INFO - Validation MAE (transformed scale): 0.0799, (original scale): 29.4988
2025-10-30 21:09:56,408 - INFO - Validation MAE (transformed scale): 0.0745, (original scale): 27.5378
2025-10-30 21:09:56,903 - INFO - Validation MAE (transformed scale): 0.0871, (original scale): 32.1617
2025-10-30 21:09:57,404 - INFO - Validation MAE (transformed scale): 0.0801, (original scale): 29.5743
2025-10-30 21:09:57,404 - INFO - Epoch 045 | Loss=0.0095 | Val MAE=0.0801 | lr=6.25e-05
2025-10-30 21:09:57,900 - INFO - Validation MAE (transformed scale): 0.0812, (original scale): 29.9844
2025-10-30 21:09:58,383 - INFO - Validation MAE (transformed scale): 0.0853, (original scale): 31.5031
2025-10-30 21:09:58,877 - INFO - Validation MAE (transformed scale): 0.0826, (original scale): 30.5084
2025-10-30 21:09:59,370 - INFO - Validation MAE (transformed scale): 0.0819, (original scale): 30.2514
2025-10-30 21:09:59,865 - INFO - Validation MAE (transformed scale): 0.0855, (original scale): 31.5780
2025-10-30 21:09:59,866 - INFO - Epoch 050 | Loss=0.0088 | Val MAE=0.0855 | lr=3.13e-05
2025-10-30 21:10:00,343 - INFO - Validation MAE (transformed scale): 0.0824, (original scale): 30.4481
2025-10-30 21:10:00,343 - INFO - Early stopping at epoch 51
2025-10-30 21:10:00,351 - INFO - ============================================================
2025-10-30 21:10:00,351 - INFO - Training completed!
2025-10-30 21:10:00,351 - INFO - Model: SAETR
2025-10-30 21:10:00,351 - INFO - Best validation MAE: 0.0718
2025-10-30 21:10:00,351 - INFO - Model saved to: train_results\train_run_saetr_20251030_210933\checkpoints\best_model.pth
2025-10-30 21:10:00,351 - INFO - ============================================================
2025-10-30 21:10:00,353 - INFO - Experiment recorded with ID: 12
2025-10-30 21:10:00,353 - INFO - Generating training curves...
2025-10-30 21:10:00,728 - INFO - Training curves saved to results directory
