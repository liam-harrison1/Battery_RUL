2025-10-30 20:52:36,821 - INFO - ============================================================
2025-10-30 20:52:36,821 - INFO - Starting training: Model = GRU
2025-10-30 20:52:36,821 - INFO - Device: cuda
2025-10-30 20:52:36,821 - INFO - Config: {'paths': {'data_dir': 'data/final_dataset', 'processed_dir': 'data/processed', 'experiment_base_dir': 'train_results', 'checkpoint_dir': 'train_results\\train_run_gru_20251030_205236\\checkpoints', 'results_dir': 'train_results\\train_run_gru_20251030_205236\\results'}, 'data_params': {'window': 50, 'stride': 10, 'min_cycles': 180}, 'model_params': {'sae_dim': 32, 'd_model': 128, 'nhead': 4, 'nlayers': 2, 'use_cnn': True, 'cnn_channels': 64, 'quantiles': [0.1, 0.5, 0.9]}, 'train_params': {'batch_size': 128, 'epochs': 200, 'learning_rate': 0.0005, 'weight_decay': 3e-05, 'alpha_recon': 0.2, 'beta_sparse': 0.001, 'y_transform': 'standardize', 'patience': 20, 'grad_clip': 1.0}, 'eval_params': {'tau': 0.8}, 'early_prediction': {'thresholds': [30, 50, 75, 100, 150], 'min_cycles': 20, 'methods': ['saetr', 'partial_discharge', 'knee_point', 'ensemble'], 'knee_detection': {'threshold_drop': 0.02, 'min_cycles_before_knee': 30}, 'partial_discharge': {'voltage_range': [3.5, 3.1]}, 'iterative': {'max_future_cycles': 500, 'feature_prediction_method': 'linear'}}}
2025-10-30 20:52:36,822 - INFO - ============================================================
2025-10-30 20:52:36,822 - INFO - Loading data...
2025-10-30 20:52:36,832 - INFO - Train: X(7239, 50, 10), y(7239,)
2025-10-30 20:52:36,832 - INFO - Val:   X(1863, 50, 10), y(1863,)
2025-10-30 20:52:36,832 - INFO - Test:  X(1375, 50, 10), y(1375,)
2025-10-30 20:52:36,832 - INFO - Fitting StandardScaler on training data...
2025-10-30 20:52:36,894 - INFO - Saved scaler to train_results\train_run_gru_20251030_205236\checkpoints\scaler.json
2025-10-30 20:52:36,894 - INFO - Applied y_transform: standardize
2025-10-30 20:52:36,894 - INFO - Sequence length: 50, Features: 10
2025-10-30 20:52:36,895 - INFO - Initializing GRU model...
2025-10-30 20:52:37,678 - INFO - Model parameters: 161,283
2025-10-30 20:52:37,678 - INFO - Starting training...
2025-10-30 20:52:43,236 - INFO - Epoch 020 | Loss=0.0383 | Val MAE=96.8882 | lr=5.00e-04
2025-10-30 20:52:44,556 - INFO - Epoch 025 | Loss=0.0342 | Val MAE=93.1492 | lr=5.00e-04
2025-10-30 20:52:45,875 - INFO - Epoch 030 | Loss=0.0308 | Val MAE=91.5385 | lr=5.00e-04
2025-10-30 20:52:47,194 - INFO - Epoch 035 | Loss=0.0286 | Val MAE=92.1535 | lr=5.00e-04
2025-10-30 20:52:48,607 - INFO - Epoch 040 | Loss=0.0261 | Val MAE=96.1468 | lr=5.00e-04
2025-10-30 20:52:52,242 - INFO - Epoch 055 | Loss=0.0176 | Val MAE=75.5598 | lr=5.00e-04
2025-10-30 20:52:53,435 - INFO - Epoch 060 | Loss=0.0159 | Val MAE=77.4928 | lr=5.00e-04
2025-10-30 20:52:54,627 - INFO - Epoch 065 | Loss=0.0164 | Val MAE=77.2567 | lr=5.00e-04
2025-10-30 20:52:55,818 - INFO - Epoch 070 | Loss=0.0125 | Val MAE=73.1825 | lr=2.50e-04
2025-10-30 20:52:57,016 - INFO - Epoch 075 | Loss=0.0114 | Val MAE=70.2377 | lr=2.50e-04
2025-10-30 20:52:58,245 - INFO - Epoch 080 | Loss=0.0108 | Val MAE=69.6766 | lr=2.50e-04
2025-10-30 20:53:00,707 - INFO - Epoch 090 | Loss=0.0094 | Val MAE=68.3478 | lr=1.25e-04
2025-10-30 20:53:01,981 - INFO - Epoch 095 | Loss=0.0092 | Val MAE=67.5080 | lr=1.25e-04
2025-10-30 20:53:05,911 - INFO - Epoch 110 | Loss=0.0083 | Val MAE=66.3371 | lr=6.25e-05
2025-10-30 20:53:07,197 - INFO - Epoch 115 | Loss=0.0083 | Val MAE=66.3271 | lr=6.25e-05
2025-10-30 20:53:08,493 - INFO - Epoch 120 | Loss=0.0081 | Val MAE=65.0728 | lr=6.25e-05
2025-10-30 20:53:09,770 - INFO - Epoch 125 | Loss=0.0078 | Val MAE=64.3259 | lr=3.13e-05
2025-10-30 20:53:12,326 - INFO - Epoch 135 | Loss=0.0075 | Val MAE=64.0828 | lr=3.13e-05
2025-10-30 20:53:13,678 - INFO - Epoch 140 | Loss=0.0074 | Val MAE=64.5684 | lr=1.56e-05
2025-10-30 20:53:14,991 - INFO - Epoch 145 | Loss=0.0073 | Val MAE=64.1540 | lr=7.81e-06
2025-10-30 20:53:16,258 - INFO - Epoch 150 | Loss=0.0074 | Val MAE=64.2004 | lr=3.91e-06
2025-10-30 20:53:16,258 - INFO - Early stopping at epoch 150
2025-10-30 20:53:16,259 - INFO - ============================================================
2025-10-30 20:53:16,259 - INFO - Training completed!
2025-10-30 20:53:16,259 - INFO - Model: GRU
2025-10-30 20:53:16,259 - INFO - Best validation MAE: 63.6136
2025-10-30 20:53:16,259 - INFO - Model saved to: train_results\train_run_gru_20251030_205236\checkpoints\best_model.pth
2025-10-30 20:53:16,259 - INFO - ============================================================
2025-10-30 20:53:16,260 - INFO - Experiment recorded with ID: 5
2025-10-30 20:53:16,260 - INFO - Generating training curves...
2025-10-30 20:53:16,660 - INFO - Training curves saved to results directory
