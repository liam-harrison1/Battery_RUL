# ç”µæ± å‰©ä½™ä½¿ç”¨å¯¿å‘½ (RUL) é¢„æµ‹



æœ¬é¡¹ç›®ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹é¢„æµ‹é”‚ç¦»å­ç”µæ± çš„å‰©ä½™ä½¿ç”¨å¯¿å‘½ (RUL)ï¼Œæ¨¡å‹æ¶æ„ä¸ºç¨€ç–è‡ªç¼–ç å™¨ + Transformer (SAETR)ã€‚



## ğŸ“‹ é¡¹ç›®æ¦‚è¿°



è¯¥é¡¹ç›®æ—¨åœ¨å®ç°è®ºæ–‡ *"Research on the remaining useful life prediction method for lithium-ion batteries by fusion of feature engineering and deep learning"* (Applied Energy, 2024) ä¸­æå‡ºçš„æ–¹æ³•ã€‚

æ¨¡å‹èåˆäº†ï¼š

- **ç¨€ç–è‡ªç¼–ç å™¨ (SAE)**: ç”¨äºç‰¹å¾å‹ç¼©å’Œæ·±åº¦ç‰¹å¾æå–ã€‚
- **Transformer**: ç”¨äºæ•æ‰æ—¶é—´åºåˆ—æ•°æ®ä¸­çš„é•¿æœŸä¾èµ–å…³ç³»ã€‚
- **åˆ†ä½æ•°å›å½’ (Quantile Regression)**: ç”¨äºå¯¹é¢„æµ‹ç»“æœè¿›è¡Œä¸ç¡®å®šæ€§é‡åŒ–ã€‚
- **ä¿å½¢é¢„æµ‹ (Conformal Prediction)**: ç”¨äºæ ¡å‡†é¢„æµ‹åŒºé—´ï¼Œä½¿å…¶æ›´å¯é ã€‚



## ğŸ—‚ï¸ é¡¹ç›®ç»“æ„



é¡¹ç›®çš„ç›®å½•ç»“æ„ç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œä»¥å®ç°æ¸…æ™°çš„å®éªŒç®¡ç†ã€‚

```
battery-rul-prediction/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                  # å­˜æ”¾åŸå§‹çš„ .csv æ•°æ®æ–‡ä»¶
â”‚   â””â”€â”€ processed/            # å­˜æ”¾é¢„å¤„ç†åç”Ÿæˆçš„åºåˆ—åŒ– .npy æ–‡ä»¶
â”œâ”€â”€ train_results/              # (æ¨èåŠ å…¥.gitignore) æ‰€æœ‰è®­ç»ƒå®éªŒçš„æ€»ç›®å½•
â”‚   â””â”€â”€ train_run_20251012_054025/ # æ¯æ¬¡è®­ç»ƒç”Ÿæˆçš„ä¸“å±æ–‡ä»¶å¤¹
â”‚       â”œâ”€â”€ checkpoints/        #   - å­˜æ”¾æ¨¡å‹æƒé‡ã€scalerç­‰
â”‚       â”‚   â”œâ”€â”€ best_model.pth
â”‚       â”‚   â”œâ”€â”€ scaler.json
â”‚       â”‚   â””â”€â”€ train_config.json
â”‚       â”œâ”€â”€ results/            #   - å­˜æ”¾è®­ç»ƒè¿‡ç¨‹æ—¥å¿—å’Œå›¾è¡¨
â”‚       â”‚   â”œâ”€â”€ training_log.csv
â”‚       â”‚   â””â”€â”€ ..._curve.png
â”‚       â””â”€â”€ predictions/        #   - (ç”±predict.pyç”Ÿæˆ) å­˜æ”¾é¢„æµ‹ç»“æœ
â”‚           â”œâ”€â”€ summary_report.txt
â”‚           â””â”€â”€ ...
â”œâ”€â”€ configs/
â”‚   â””â”€â”€ config.yaml             # ç»Ÿä¸€ç®¡ç†æ‰€æœ‰è¶…å‚æ•°å’Œè·¯å¾„
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ metrics.py              # è¯„ä¼°æŒ‡æ ‡è®¡ç®—
â”‚   â””â”€â”€ helpers.py              # å¯è§†åŒ–ã€æ—¥å¿—ç­‰è¾…åŠ©å‡½æ•°
â”œâ”€â”€ dataset.py                  # æ•°æ®é›†å®šä¹‰å’ŒåŠ è½½å·¥å…·
â”œâ”€â”€ model.py                    # SAETR æ¨¡å‹æ¶æ„
â”œâ”€â”€ preprocess.py               # æ•°æ®é¢„å¤„ç†è„šæœ¬
â”œâ”€â”€ train.py                    # æ¨¡å‹è®­ç»ƒè„šæœ¬
â”œâ”€â”€ predict.py                  # æ¨¡å‹é¢„æµ‹ä¸è¯„ä¼°è„šæœ¬
â”œâ”€â”€ requirements.txt            # é¡¹ç›®ä¾èµ–
â””â”€â”€ README.md                   # æœ¬æ–‡æ¡£
```



## ğŸš€ å¿«é€Ÿå¼€å§‹





### 1. ç¯å¢ƒè®¾ç½®



Bash

```
# åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ (æ¨è)
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```



### 2. å‡†å¤‡æ•°æ®



å°†ä½ çš„ç”µæ± æ•°æ® CSV æ–‡ä»¶æ”¾å…¥ `data/raw/` ç›®å½•ã€‚è„šæœ¬ä¼šæ ¹æ®æ–‡ä»¶åè‡ªåŠ¨è¯†åˆ«è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•é›†ã€‚

- `tabular_train.csv`
- `tabular_val.csv`
- `tabular_test.csv`



### 3. æ•°æ®é¢„å¤„ç†



è¯¥è„šæœ¬ä¼šå°†è¡¨æ ¼æ•°æ®è½¬æ¢æˆé€‚ç”¨äº Transformer çš„æ»‘åŠ¨çª—å£åºåˆ—ã€‚å¤„ç†åçš„ `.npy` æ–‡ä»¶ä¼šä¿å­˜åœ¨ `data/processed/` ç›®å½•ä¸‹ã€‚

Bash

```
python preprocess.py --config configs/config.yaml
```



### 4. è®­ç»ƒæ¨¡å‹



è¿è¡Œè®­ç»ƒè„šæœ¬ã€‚è„šæœ¬å°†è‡ªåŠ¨è¿›è¡Œè®­ç»ƒã€éªŒè¯ï¼Œå¹¶ä¿å­˜æ€§èƒ½æœ€ä½³çš„æ¨¡å‹ã€‚

è®­ç»ƒå®Œæˆåï¼Œä¼šåœ¨ `train_results/` ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª**å¸¦æ—¶é—´æˆ³çš„ä¸“å±æ–‡ä»¶å¤¹**ï¼Œä¾‹å¦‚ `train_results/train_run_20251012_054025/`ã€‚æ‰€æœ‰è®­ç»ƒäº§ç‰©éƒ½åœ¨é‡Œé¢ï¼š

- **`/checkpoints/best_model.pth`**: éªŒè¯é›†ä¸Šæ€§èƒ½æœ€ä½³çš„æ¨¡å‹æƒé‡ã€‚
- **`/checkpoints/scaler.json`**: ç”¨äºç‰¹å¾æ ‡å‡†åŒ–çš„ scaler å‚æ•°ã€‚
- **`/checkpoints/train_config.json`**: æœ¬æ¬¡è®­ç»ƒçš„å…³é”®é…ç½®å‚æ•°ã€‚
- **`/results/training_log.csv`**: æ¯ä¸ª epoch çš„è®­ç»ƒæŸå¤±å’ŒéªŒè¯ MAEã€‚
- **`/results/\*_curve.png`**: è®­ç»ƒè¿‡ç¨‹å¯è§†åŒ–æ›²çº¿å›¾ã€‚

Bash

```
python train.py --config configs/config.yaml
```



### 5. è¯„ä¼°æ¨¡å‹



ä½¿ç”¨ `predict.py` è„šæœ¬åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°ä½ æŒ‡å®šçš„æ¨¡å‹ã€‚**è¿™æ˜¯ä¸æ—§æµç¨‹æœ€å¤§çš„ä¸åŒç‚¹**ã€‚

ä½ **å¿…é¡»**ä½¿ç”¨ `--run_dir` å‚æ•°æ¥æŒ‡å®šè¦è¯„ä¼°å“ªä¸€æ¬¡çš„è®­ç»ƒç»“æœã€‚è¯„ä¼°è„šæœ¬ä¼šè‡ªåŠ¨åŠ è½½è¯¥æ–‡ä»¶å¤¹å†…çš„æ¨¡å‹å’Œé…ç½®ï¼Œå¹¶å°†æ‰€æœ‰é¢„æµ‹ç»“æœä¿å­˜åœ¨å…¶å†…éƒ¨ä¸€ä¸ªåä¸º `predictions/` çš„æ–°å­æ–‡ä»¶å¤¹ä¸­ï¼Œæ–¹ä¾¿ç»“æœçš„ç»Ÿä¸€ç®¡ç†ã€‚

Bash

```
# å¤åˆ¶ä¸Šä¸€æ­¥è®­ç»ƒç”Ÿæˆçš„æ–‡ä»¶å¤¹è·¯å¾„ï¼Œä½œä¸º --run_dir å‚æ•°ä¼ å…¥
python predict.py --config configs/config.yaml --run_dir train_results/train_run_20251012_054025
```



## âš™ï¸ é…ç½®



æ‰€æœ‰å®éªŒå‚æ•°éƒ½åœ¨ `configs/config.yaml` ä¸­è¿›è¡Œç»Ÿä¸€ç®¡ç†ã€‚

**è·¯å¾„è®¾ç½® (`paths`):**

- `experiment_base_dir`: æ‰€æœ‰è®­ç»ƒå®éªŒçš„æ€»è¾“å‡ºç›®å½• (ä¾‹å¦‚: `train_results`)ã€‚

**æ¨¡å‹å‚æ•° (`model_params`):**

- `sae_dim`: è‡ªç¼–ç å™¨çš„éšè—å±‚ç»´åº¦ã€‚
- `d_model`: Transformer çš„æ¨¡å‹ç»´åº¦ã€‚
- `nhead`, `nlayers`: Transformer çš„å¤´æ•°å’Œå±‚æ•°ã€‚

**è®­ç»ƒå‚æ•° (`train_params`):**

- `batch_size`, `epochs`, `learning_rate`: æ ‡å‡†è®­ç»ƒè¶…å‚æ•°ã€‚
- `patience`: æ—©åœæœºåˆ¶çš„è€å¿ƒè½®æ•°ã€‚



## ğŸ“Š é¢„æœŸæ€§èƒ½



æ ¹æ®åŸè®ºæ–‡ï¼Œæ¨¡å‹åœ¨å…¬å¼€æ•°æ®é›†ä¸Šå¯ä»¥è¾¾åˆ°ï¼š

- **MAE**: çº¦ 13 ä¸ªå¾ªç¯
- **MAPE**: åœ¨å¤šç§ç”µæ± ä¸Šä½äº 7.5%



## ğŸ“ å…³é”®ç‰¹æ€§



- **å®éªŒç®¡ç†**: æ¯æ¬¡è®­ç»ƒçš„äº§ç‰©ï¼ˆæ¨¡å‹ã€æ—¥å¿—ã€å›¾è¡¨ï¼‰éƒ½ä¿å­˜åœ¨ç‹¬ç«‹çš„ã€å¸¦æ—¶é—´æˆ³çš„æ–‡ä»¶å¤¹ä¸­ï¼Œä¾¿äºè¿½æº¯ã€æ¯”è¾ƒå’Œå¤ç°ã€‚
- **è§£è€¦çš„å·¥ä½œæµ**: è®­ç»ƒ (`train.py`) å’Œé¢„æµ‹ (`predict.py`) å®Œå…¨åˆ†ç¦»ï¼Œé¢„æµ‹æ—¶å¯çµæ´»æŒ‡å®šä»»æ„ä¸€æ¬¡çš„è®­ç»ƒç»“æœã€‚
- **ä¸ç¡®å®šæ€§é‡åŒ–**: ç»“åˆåˆ†ä½æ•°å›å½’å’Œä¿å½¢é¢„æµ‹ï¼Œæä¾›å¯é çš„é¢„æµ‹åŒºé—´ã€‚
- **æ¨¡å—åŒ–è®¾è®¡**: ä»£ç ç»“æ„æ¸…æ™°ï¼ŒåŠŸèƒ½åˆ†ç¦»ï¼Œæ˜“äºä¿®æ”¹å’Œæ‰©å±•ã€‚



## ğŸ“š å¼•ç”¨



è‹¥æ‚¨åœ¨ç ”ç©¶ä¸­ä½¿ç”¨äº†æœ¬é¡¹ç›®çš„ä»£ç ï¼Œè¯·å¼•ç”¨åŸè®ºæ–‡ï¼š

ä»£ç æ®µ

```
@article{zhao2024rul,
  title= {Research on the remaining useful life prediction method for lithium-ion batteries by fusion of feature engineering and deep learning},
  author= {Zhao, Bo and Zhang, Weige and Zhang, Yanru and Zhang, Caiping and Zhang, Chi and Zhang, Junwei},
  journal={Applied Energy},
  volume={358},
  pages={122325},
  year={2024}
}
```

------



## ä½¿ç”¨è¯´æ˜





### å®Œæ•´å·¥ä½œæµç¨‹



1. **å‡†å¤‡æ•°æ®**: å°† `tabular_train.csv`, `tabular_val.csv`, `tabular_test.csv` æ”¾å…¥ `data/raw/`ã€‚

2. **æ•°æ®é¢„å¤„ç†**:

   Bash

   ```
   python preprocess.py
   ```

3. è®­ç»ƒæ¨¡å‹:

   è®­ç»ƒä¼šè‡ªåŠ¨ä¿å­˜æœ€ä½³æ¨¡å‹ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªç±»ä¼¼ train_results/train_run_20251012_054025 çš„æ–‡ä»¶å¤¹ã€‚

   Bash

   ```
   python train.py
   ```

4. è¯„ä¼°é¢„æµ‹:

   è„šæœ¬ä¼šåœ¨æŒ‡å®šçš„æ–‡ä»¶å¤¹å†…ç”Ÿæˆ predictions å­ç›®å½•å¹¶ä¿å­˜æ‰€æœ‰è¯„ä¼°ç»“æœã€‚

   Bash

   ```
   # å¿…é¡»ç”¨ --run_dir æŒ‡å®šè¦è¯„ä¼°çš„è®­ç»ƒæ–‡ä»¶å¤¹
   python predict.py --run_dir train_results/train_run_20251012_054025
   ```



### å…³é”®æ”¹è¿›ç‚¹



âœ… **ä¸“ä¸šçš„å®éªŒç®¡ç†**: æ¯æ¬¡è®­ç»ƒå’Œé¢„æµ‹çš„ç»“æœè‡ªåŠ¨ä¿å­˜åˆ°å¸¦æ—¶é—´æˆ³çš„ç‹¬ç«‹æ–‡ä»¶å¤¹ï¼Œæ–¹ä¾¿è¿½æº¯å’Œæ¯”è¾ƒã€‚

âœ… **çµæ´»çš„é¢„æµ‹æµç¨‹**: å¯é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ï¼Œè½»æ¾æŒ‡å®šä»»æ„ä¸€æ¬¡å†å²è®­ç»ƒçš„æ¨¡å‹è¿›è¡Œè¯„ä¼°ï¼Œå®Œç¾æ”¯æŒæ¨¡å‹å¯¹æ¯”ã€‚

âœ… **ç»Ÿä¸€é…ç½®ç®¡ç†**: æ‰€æœ‰è¶…å‚æ•°åœ¨ `config.yaml` ä¸­ç»Ÿä¸€ç®¡ç†ï¼Œå®éªŒé…ç½®æ¸…æ™°æ˜äº†ã€‚

âœ… **ä¸°å¯Œçš„å¯è§†åŒ–**: åŒ…æ‹¬æŸå¤±æ›²çº¿ã€æ•£ç‚¹å›¾ã€åˆ†ä½æ•°è¦†ç›–ã€å•ç”µæ± è¿½è¸ªç­‰ï¼Œå…¨æ–¹ä½è¯„ä¼°æ¨¡å‹æ€§èƒ½ã€‚